#!/bin/bash

awk '
BEGIN { FS = OFS = "\t" }
FILENAME ~ /usable.*converted-urls/ {
  usable[$1] = 1
}
FILENAME ~ /conversions/ {
  conv[$1] = $2
  next
}
FILENAME ~ /links_raw/ {
  if (usable[conv[$3]]) {
    print $1, conv[$3]
  }
}
' data/http-https-conversions.tsv data/usable-http-https-converted-urls.tsv data/exploitdb_links_raw.tsv

