#!/bin/bash

awk '
BEGIN {
  FS = OFS = "\t"
  datafile = "data/usable-raw-urls.tsv"
  while (getline < datafile) {
    usable_urls[$1] = 1
  }
  close(datafile)
  datafile = "data/exploitdb-direct-links.tsv"
  while (getline < datafile) {
    url_for[$1] = $2
  }
  close(datafile)
  datafile = "data-entry-urls.tsv"
  while (getline < datafile) {
    url_for[$1] = $2
  }
  close(datafile)
}
$1 in url_for {
  print $1, $2, url_for[$1]
  next
}
$3 in usable_urls { print }
' data/exploitdb_links_raw.tsv
