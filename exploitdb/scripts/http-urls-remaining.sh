#!/bin/bash

awk '
BEGIN { FS = OFS = "\t" }
$1 ~ /^http:/ {
  url = $1
  if (!seen[url]) {
    newurl = url
    gsub(/^http:/,"https:",newurl)
    print url, newurl > "data/http-https-conversions.tsv"
    print "scripts/sample-url-filetype.sh \047" newurl "\047"
    #gsub(/^.dev.stdin: /,"",result)
    #print url, newurl, result
    seen[url] = 1
  }
}
' data/remaining-to-process.tsv | parallel -j 30
